<!DOCTYPE html>
<html>
<head>
  <title>Profile</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="bg-light">
<header style="display: flex; justify-content: flex-start; align-items: center; padding: 10px 20px; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
  <img src="https://pminternship.mca.gov.in/assets/img/MCA.svg" alt="MCA Logo" style="height: 50px; margin-right: 20px;">
  <img src="https://pminternship.mca.gov.in/assets/images/img/pm_internship_logo_eng.svg" alt="PM Internship Logo" style="height: 50px;">
</header>
<div class="container mt-5 fade-in">
  <h2>Your Profile</h2>
  <div id="profileDisplay">
    <div class="mb-3">
      <label class="form-label">Name</label>
      <p id="displayName" class="form-control-plaintext"></p>
    </div>
    <div class="mb-3">
      <label class="form-label">Email</label>
      <p id="displayEmail" class="form-control-plaintext"></p>
    </div>
    <div class="mb-3">
      <label class="form-label">Skills</label>
      <p id="displaySkills" class="form-control-plaintext"></p>
    </div>
    <div class="mb-3">
      <label class="form-label">Location</label>
      <p id="displayLocation" class="form-control-plaintext"></p>
    </div>
    <button type="button" class="btn btn-modern btn-primary-modern" onclick="editProfile()">Edit Profile</button>
    <a href="index.html" class="btn btn-modern btn-link-modern mt-3">Back to Home</a>
  </div>
  <div id="profileEdit" style="display: none;">
    <form id="editForm">
      <div class="mb-3">
        <label class="form-label">Name</label>
        <input type="text" class="form-control" id="editName" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Email</label>
        <input type="email" class="form-control" id="editEmail" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Skills</label>
        <input type="text" class="form-control" id="editSkills" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Location</label>
        <input type="text" class="form-control" id="editLocation" required>
      </div>
      <button type="submit" class="btn btn-modern btn-success-modern">Save Changes</button>
      <button type="button" class="btn btn-modern btn-secondary" onclick="cancelEdit()">Cancel</button>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Load profile data from localStorage
  function loadProfile() {
    const userKey = sessionStorage.getItem('currentUser');
    if (userKey) {
      const profile = JSON.parse(localStorage.getItem(userKey));
      if (profile) {
        document.getElementById('displayName').textContent = profile.name;
        document.getElementById('displayEmail').textContent = profile.email;
        document.getElementById('displaySkills').textContent = profile.skills;
        document.getElementById('displayLocation').textContent = profile.location;
      } else {
        // If no profile, redirect to signup
        window.location.href = 'signup.html';
      }
    } else {
      window.location.href = 'login.html';
    }
  }

  function editProfile() {
    const userKey = sessionStorage.getItem('currentUser');
    const profile = JSON.parse(localStorage.getItem(userKey));
    document.getElementById('editName').value = profile.name;
    document.getElementById('editEmail').value = profile.email;
    document.getElementById('editSkills').value = profile.skills;
    document.getElementById('editLocation').value = profile.location;
    document.getElementById('profileDisplay').style.display = 'none';
    document.getElementById('profileEdit').style.display = 'block';
  }

  function cancelEdit() {
    document.getElementById('profileDisplay').style.display = 'block';
    document.getElementById('profileEdit').style.display = 'none';
  }

  document.getElementById('editForm').addEventListener('submit', function(event) {
    event.preventDefault();
    const updatedProfile = {
      name: document.getElementById('editName').value,
      email: document.getElementById('editEmail').value,
      skills: document.getElementById('editSkills').value,
      location: document.getElementById('editLocation').value
    };
    const userKey = sessionStorage.getItem('currentUser');
    localStorage.setItem(userKey, JSON.stringify(updatedProfile));
    loadProfile();
    cancelEdit();
  });

  // Load profile on page load
  loadProfile();
</script>
</body>
</html>
